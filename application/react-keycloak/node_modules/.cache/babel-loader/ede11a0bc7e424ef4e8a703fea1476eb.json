{"ast":null,"code":"var _jsxFileName = \"/home/dominik/IdeaProjects/react-keycloak/src/index.js\";\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport * as Keycloak from 'keycloak-js';\nimport $ from \"jQuery\"; //keycloak init options\n\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nlet initOptions = {\n  url: 'http://192.168.49.2:30858/',\n  realm: 'react-realm',\n  clientId: 'react-login-client',\n  onLoad: 'login-required'\n};\nlet keycloak = Keycloak(initOptions);\nkeycloak.init({\n  onLoad: initOptions.onLoad\n}).success(auth => {\n  if (!auth) {\n    window.location.reload();\n  } else {\n    console.info(\"Authenticated\");\n  }\n\n  localStorage.setItem(\"bearer-token\", keycloak.token);\n  localStorage.setItem(\"refresh-token\", keycloak.refreshToken);\n  console.log(keycloak.token);\n  setTimeout(() => {\n    keycloak.updateToken(70).success(refreshed => {\n      if (refreshed) {\n        console.debug('Token refreshed' + refreshed);\n      } else {\n        console.warn('Token not refreshed, valid for ' + Math.round(keycloak.tokenParsed.exp + keycloak.timeSkew - new Date().getTime() / 1000) + ' seconds');\n      }\n    }).error(() => {\n      console.error('Failed to refresh token');\n    });\n  }, 60000);\n}).error(() => {\n  console.error(\"Authenticated Failed\");\n});\n\nfunction LogOut() {\n  const logout = () => {\n    keycloak.logout();\n  };\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: logout,\n      children: \"Logout\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 61,\n      columnNumber: 9\n    }, this)\n  }, void 0, false);\n}\n\n_c = LogOut;\nReactDOM.render( /*#__PURE__*/_jsxDEV(LogOut, {}, void 0, false, {\n  fileName: _jsxFileName,\n  lineNumber: 69,\n  columnNumber: 17\n}, this), document.getElementById(\"logoutBtn\"));\n\nfunction CheckRoles() {\n  const check = () => {\n    $.ajax({\n      type: \"GET\",\n      url: \"http://localhost:8080/check/admin\",\n      headers: {\n        'Authorization': 'Bearer ' + localStorage.getItem(\"bearer-token\")\n      },\n      success: function (data1) {\n        document.getElementById(\"admin\").innerHTML = data1;\n      },\n      error: function (error) {\n        document.getElementById(\"admin\").innerHTML = \"You dont have admin privilages\";\n      }\n    });\n    $.ajax({\n      type: \"GET\",\n      url: \"http://localhost:8080/check/customer\",\n      headers: {\n        'Authorization': 'Bearer ' + localStorage.getItem(\"bearer-token\")\n      },\n      success: function (data2) {\n        document.getElementById(\"cust\").innerHTML = data2;\n      },\n      error: function (error) {\n        document.getElementById(\"cust\").innerHTML = \"You dont have customer privilages\";\n      }\n    });\n  };\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(\"p\", {\n      children: [\" Check Admin privilages at \", /*#__PURE__*/_jsxDEV(\"strong\", {\n        children: \"/check/admin\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 108,\n        columnNumber: 37\n      }, this), \" and check Customer privilages at \", /*#__PURE__*/_jsxDEV(\"strong\", {\n        children: \"/check/customer\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 108,\n        columnNumber: 100\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 108,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: check,\n      children: \"Check\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 110,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n      id: \"admin\",\n      children: \" \"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 113,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n      id: \"cust\",\n      children: \" \"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 114,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true);\n}\n\n_c2 = CheckRoles;\nReactDOM.render( /*#__PURE__*/_jsxDEV(CheckRoles, {}, void 0, false, {\n  fileName: _jsxFileName,\n  lineNumber: 118,\n  columnNumber: 17\n}, this), document.getElementById(\"root\"));\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"LogOut\");\n$RefreshReg$(_c2, \"CheckRoles\");","map":{"version":3,"sources":["/home/dominik/IdeaProjects/react-keycloak/src/index.js"],"names":["React","ReactDOM","Keycloak","$","initOptions","url","realm","clientId","onLoad","keycloak","init","success","auth","window","location","reload","console","info","localStorage","setItem","token","refreshToken","log","setTimeout","updateToken","refreshed","debug","warn","Math","round","tokenParsed","exp","timeSkew","Date","getTime","error","LogOut","logout","render","document","getElementById","CheckRoles","check","ajax","type","headers","getItem","data1","innerHTML","data2"],"mappings":"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","sourcesContent":["import React from 'react';\nimport ReactDOM from 'react-dom';\nimport * as Keycloak from 'keycloak-js'\nimport $ from \"jQuery\";\n\n\n\n//keycloak init options\nlet initOptions = {\n    url: 'http://192.168.49.2:30858/',\n    realm: 'react-realm', \n    clientId: 'react-login-client', \n    onLoad: 'login-required'\n}\n\n\n\n\nlet keycloak = Keycloak(initOptions);\n\nkeycloak.init({ onLoad: initOptions.onLoad }).success((auth) => {\n\n    if (!auth) {\n        window.location.reload();\n    } else {\n        console.info(\"Authenticated\");\n    }\n\n    localStorage.setItem(\"bearer-token\", keycloak.token);\n    localStorage.setItem(\"refresh-token\", keycloak.refreshToken);\n    console.log(keycloak.token);\n\n    setTimeout(() => {\n        keycloak.updateToken(70).success((refreshed) => {\n            if (refreshed) {\n                console.debug('Token refreshed' + refreshed);\n            } else {\n                console.warn('Token not refreshed, valid for '\n                    + Math.round(keycloak.tokenParsed.exp + keycloak.timeSkew - new Date().getTime() / 1000) + ' seconds');\n            }\n        }).error(() => {\n            console.error('Failed to refresh token');\n        });\n\n\n    }, 60000)\n\n}).error(() => {\n    console.error(\"Authenticated Failed\");\n});\n\n\n\nfunction LogOut(){\n    const logout = ()=>{\n        keycloak.logout();\n    };\n\n    return (\n     <>\n        <button  onClick={logout}>\n          Logout\n        </button>\n    </>\n\n    );\n}\n\nReactDOM.render(<LogOut />, document.getElementById(\"logoutBtn\"));\n\n\n\nfunction CheckRoles() {\n  const check = () => {\n    $.ajax({\n      type: \"GET\",\n      url: \"http://localhost:8080/check/admin\",\n      headers : {\n         'Authorization': 'Bearer ' + localStorage.getItem(\"bearer-token\")\n      },\n      success: function (data1) {\n        document.getElementById(\"admin\").innerHTML = data1;\n      },\n      error: function (error) {\n        document.getElementById(\"admin\").innerHTML = \"You dont have admin privilages\";\n      }\n    });\n\n    $.ajax({\n      type: \"GET\",\n      url: \"http://localhost:8080/check/customer\",\n      headers : {\n         'Authorization': 'Bearer ' + localStorage.getItem(\"bearer-token\")\n      },\n      success: function (data2) {\n        document.getElementById(\"cust\").innerHTML = data2;\n      },\n      error: function (error) {\n        document.getElementById(\"cust\").innerHTML = \"You dont have customer privilages\";\n      }\n    });\n\n\n  };\n\n  return (\n    <>\n      <p> Check Admin privilages at <strong>/check/admin</strong> and check Customer privilages at <strong>/check/customer</strong>\n      </p>\n      <button onClick={check} >\n        Check \n      </button>\n      <p id=\"admin\"> </p>\n      <p id=\"cust\"> </p>\n    </>\n  );\n}\nReactDOM.render(<CheckRoles />, document.getElementById(\"root\"));\n\n\n"]},"metadata":{},"sourceType":"module"}