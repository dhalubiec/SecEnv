{"ast":null,"code":"var _jsxFileName = \"/home/dominik/IdeaProjects/react-keycloak/src/index.js\";\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport Keycloak from \"keycloak-js\";\nimport $ from \"jQuery\";\n\n//keycloak init options\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nlet initOptions = {\n  url: 'http://192.168.49.2:30858/',\n  realm: 'react-realm',\n  clientId: 'react-login-client',\n  onLoad: 'login-required'\n};\nconst keycloak = new Keycloak(initOptions);\nkeycloak.init({\n  onLoad: initOptions.onLoad\n}).then(auth => {\n  if (!auth) {\n    window.location.reload();\n  } else {\n    console.info(\"Authenticated\");\n  }\n  localStorage.setItem(\"bearer-token\", keycloak.token);\n  localStorage.setItem(\"refresh-token\", keycloak.refreshToken);\n  console.log(keycloak.token);\n  setTimeout(() => {\n    keycloak.updateToken(70).then(refreshed => {\n      if (refreshed) {\n        console.debug('Token refreshed' + refreshed);\n      } else {\n        console.warn('Token not refreshed, valid for ' + Math.round(keycloak.tokenParsed.exp + keycloak.timeSkew - new Date().getTime() / 1000) + ' seconds');\n      }\n    }).catch(() => {\n      console.error('Failed to refresh token');\n    });\n  }, 60000);\n}).catch(() => {\n  console.error(\"Authenticated Failed\");\n});\nfunction LogOut() {\n  const logout = () => {\n    keycloak.logout();\n  };\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: logout,\n      children: \"Logout\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 59,\n      columnNumber: 9\n    }, this)\n  }, void 0, false);\n}\n_c = LogOut;\nReactDOM.render( /*#__PURE__*/_jsxDEV(LogOut, {}, void 0, false, {\n  fileName: _jsxFileName,\n  lineNumber: 67,\n  columnNumber: 17\n}, this), document.getElementById(\"logoutBtn\"));\nfunction CheckRoles() {\n  const check = () => {\n    $.ajax({\n      type: \"GET\",\n      url: \"http://localhost:8081/check/admin\",\n      headers: {\n        'Authorization': 'Bearer ' + localStorage.getItem(\"bearer-token\")\n      },\n      success: function (data1) {\n        document.getElementById(\"admin\").innerHTML = data1;\n      },\n      error: function (error) {\n        document.getElementById(\"admin\").innerHTML = \"You dont have admin privilages\";\n      }\n    });\n    $.ajax({\n      type: \"GET\",\n      url: \"http://localhost:8081/check/customer\",\n      headers: {\n        'Authorization': 'Bearer ' + localStorage.getItem(\"bearer-token\")\n      },\n      success: function (data2) {\n        document.getElementById(\"cust\").innerHTML = data2;\n      },\n      error: function (error) {\n        document.getElementById(\"cust\").innerHTML = \"You dont have customer privilages\";\n      }\n    });\n  };\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(\"p\", {\n      children: [\" Check Admin privilages at \", /*#__PURE__*/_jsxDEV(\"strong\", {\n        children: \"/check/admin\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 106,\n        columnNumber: 37\n      }, this), \" and check Customer privilages at \", /*#__PURE__*/_jsxDEV(\"strong\", {\n        children: \"/check/customer\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 106,\n        columnNumber: 100\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 106,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: check,\n      children: \"Check\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 108,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n      id: \"admin\",\n      children: \" \"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 111,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n      id: \"cust\",\n      children: \" \"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 112,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true);\n}\n_c2 = CheckRoles;\nReactDOM.render( /*#__PURE__*/_jsxDEV(CheckRoles, {}, void 0, false, {\n  fileName: _jsxFileName,\n  lineNumber: 116,\n  columnNumber: 17\n}, this), document.getElementById(\"root\"));\nvar _c, _c2;\n$RefreshReg$(_c, \"LogOut\");\n$RefreshReg$(_c2, \"CheckRoles\");","map":{"version":3,"names":["React","ReactDOM","Keycloak","$","initOptions","url","realm","clientId","onLoad","keycloak","init","then","auth","window","location","reload","console","info","localStorage","setItem","token","refreshToken","log","setTimeout","updateToken","refreshed","debug","warn","Math","round","tokenParsed","exp","timeSkew","Date","getTime","catch","error","LogOut","logout","render","document","getElementById","CheckRoles","check","ajax","type","headers","getItem","success","data1","innerHTML","data2"],"sources":["/home/dominik/IdeaProjects/react-keycloak/src/index.js"],"sourcesContent":["import React from 'react';\nimport ReactDOM from 'react-dom';\nimport Keycloak from \"keycloak-js\";\nimport $ from \"jQuery\";\n\n\n\n//keycloak init options\nlet initOptions = {\n    url: 'http://192.168.49.2:30858/',\n    realm: 'react-realm', \n    clientId: 'react-login-client', \n    onLoad: 'login-required'\n}\n\nconst keycloak = new Keycloak(initOptions);\n\n\nkeycloak.init({ onLoad: initOptions.onLoad }).then((auth) => {\n\n    if (!auth) {\n        window.location.reload();\n    } else {\n        console.info(\"Authenticated\");\n    }\n\n    localStorage.setItem(\"bearer-token\", keycloak.token);\n    localStorage.setItem(\"refresh-token\", keycloak.refreshToken);\n    console.log(keycloak.token);\n\n    setTimeout(() => {\n        keycloak.updateToken(70).then((refreshed) => {\n            if (refreshed) {\n                console.debug('Token refreshed' + refreshed);\n            } else {\n                console.warn('Token not refreshed, valid for '\n                    + Math.round(keycloak.tokenParsed.exp + keycloak.timeSkew - new Date().getTime() / 1000) + ' seconds');\n            }\n        }).catch(() => {\n            console.error('Failed to refresh token');\n        });\n\n\n    }, 60000)\n\n}).catch(() => {\n    console.error(\"Authenticated Failed\");\n});\n\n\n\nfunction LogOut(){\n    const logout = ()=>{\n        keycloak.logout();\n    };\n\n    return (\n     <>\n        <button  onClick={logout}>\n          Logout\n        </button>\n    </>\n\n    );\n}\n\nReactDOM.render(<LogOut />, document.getElementById(\"logoutBtn\"));\n\n\n\nfunction CheckRoles() {\n  const check = () => {\n    $.ajax({\n      type: \"GET\",\n      url: \"http://localhost:8081/check/admin\",\n      headers : {\n         'Authorization': 'Bearer ' + localStorage.getItem(\"bearer-token\")\n      },\n      success: function (data1) {\n        document.getElementById(\"admin\").innerHTML = data1;\n      },\n      error: function (error) {\n        document.getElementById(\"admin\").innerHTML = \"You dont have admin privilages\";\n      }\n    });\n\n    $.ajax({\n      type: \"GET\",\n      url: \"http://localhost:8081/check/customer\",\n      headers : {\n         'Authorization': 'Bearer ' + localStorage.getItem(\"bearer-token\")\n      },\n      success: function (data2) {\n        document.getElementById(\"cust\").innerHTML = data2;\n      },\n      error: function (error) {\n        document.getElementById(\"cust\").innerHTML = \"You dont have customer privilages\";\n      }\n    });\n\n\n  };\n\n  return (\n    <>\n      <p> Check Admin privilages at <strong>/check/admin</strong> and check Customer privilages at <strong>/check/customer</strong>\n      </p>\n      <button onClick={check} >\n        Check \n      </button>\n      <p id=\"admin\"> </p>\n      <p id=\"cust\"> </p>\n    </>\n  );\n}\nReactDOM.render(<CheckRoles />, document.getElementById(\"root\"));\n\n\n"],"mappings":";AAAA,OAAOA,KAAK,MAAM,OAAO;AACzB,OAAOC,QAAQ,MAAM,WAAW;AAChC,OAAOC,QAAQ,MAAM,aAAa;AAClC,OAAOC,CAAC,MAAM,QAAQ;;AAItB;AAAA;AAAA;AACA,IAAIC,WAAW,GAAG;EACdC,GAAG,EAAE,4BAA4B;EACjCC,KAAK,EAAE,aAAa;EACpBC,QAAQ,EAAE,oBAAoB;EAC9BC,MAAM,EAAE;AACZ,CAAC;AAED,MAAMC,QAAQ,GAAG,IAAIP,QAAQ,CAACE,WAAW,CAAC;AAG1CK,QAAQ,CAACC,IAAI,CAAC;EAAEF,MAAM,EAAEJ,WAAW,CAACI;AAAO,CAAC,CAAC,CAACG,IAAI,CAAEC,IAAI,IAAK;EAEzD,IAAI,CAACA,IAAI,EAAE;IACPC,MAAM,CAACC,QAAQ,CAACC,MAAM,EAAE;EAC5B,CAAC,MAAM;IACHC,OAAO,CAACC,IAAI,CAAC,eAAe,CAAC;EACjC;EAEAC,YAAY,CAACC,OAAO,CAAC,cAAc,EAAEV,QAAQ,CAACW,KAAK,CAAC;EACpDF,YAAY,CAACC,OAAO,CAAC,eAAe,EAAEV,QAAQ,CAACY,YAAY,CAAC;EAC5DL,OAAO,CAACM,GAAG,CAACb,QAAQ,CAACW,KAAK,CAAC;EAE3BG,UAAU,CAAC,MAAM;IACbd,QAAQ,CAACe,WAAW,CAAC,EAAE,CAAC,CAACb,IAAI,CAAEc,SAAS,IAAK;MACzC,IAAIA,SAAS,EAAE;QACXT,OAAO,CAACU,KAAK,CAAC,iBAAiB,GAAGD,SAAS,CAAC;MAChD,CAAC,MAAM;QACHT,OAAO,CAACW,IAAI,CAAC,iCAAiC,GACxCC,IAAI,CAACC,KAAK,CAACpB,QAAQ,CAACqB,WAAW,CAACC,GAAG,GAAGtB,QAAQ,CAACuB,QAAQ,GAAG,IAAIC,IAAI,EAAE,CAACC,OAAO,EAAE,GAAG,IAAI,CAAC,GAAG,UAAU,CAAC;MAC9G;IACJ,CAAC,CAAC,CAACC,KAAK,CAAC,MAAM;MACXnB,OAAO,CAACoB,KAAK,CAAC,yBAAyB,CAAC;IAC5C,CAAC,CAAC;EAGN,CAAC,EAAE,KAAK,CAAC;AAEb,CAAC,CAAC,CAACD,KAAK,CAAC,MAAM;EACXnB,OAAO,CAACoB,KAAK,CAAC,sBAAsB,CAAC;AACzC,CAAC,CAAC;AAIF,SAASC,MAAM,GAAE;EACb,MAAMC,MAAM,GAAG,MAAI;IACf7B,QAAQ,CAAC6B,MAAM,EAAE;EACrB,CAAC;EAED,oBACC;IAAA,uBACG;MAAS,OAAO,EAAEA,MAAO;MAAA;IAAA;MAAA;MAAA;MAAA;IAAA;EAEhB,iBACV;AAGP;AAAC,KAbQD,MAAM;AAefpC,QAAQ,CAACsC,MAAM,eAAC,QAAC,MAAM;EAAA;EAAA;EAAA;AAAA,QAAG,EAAEC,QAAQ,CAACC,cAAc,CAAC,WAAW,CAAC,CAAC;AAIjE,SAASC,UAAU,GAAG;EACpB,MAAMC,KAAK,GAAG,MAAM;IAClBxC,CAAC,CAACyC,IAAI,CAAC;MACLC,IAAI,EAAE,KAAK;MACXxC,GAAG,EAAE,mCAAmC;MACxCyC,OAAO,EAAG;QACP,eAAe,EAAE,SAAS,GAAG5B,YAAY,CAAC6B,OAAO,CAAC,cAAc;MACnE,CAAC;MACDC,OAAO,EAAE,UAAUC,KAAK,EAAE;QACxBT,QAAQ,CAACC,cAAc,CAAC,OAAO,CAAC,CAACS,SAAS,GAAGD,KAAK;MACpD,CAAC;MACDb,KAAK,EAAE,UAAUA,KAAK,EAAE;QACtBI,QAAQ,CAACC,cAAc,CAAC,OAAO,CAAC,CAACS,SAAS,GAAG,gCAAgC;MAC/E;IACF,CAAC,CAAC;IAEF/C,CAAC,CAACyC,IAAI,CAAC;MACLC,IAAI,EAAE,KAAK;MACXxC,GAAG,EAAE,sCAAsC;MAC3CyC,OAAO,EAAG;QACP,eAAe,EAAE,SAAS,GAAG5B,YAAY,CAAC6B,OAAO,CAAC,cAAc;MACnE,CAAC;MACDC,OAAO,EAAE,UAAUG,KAAK,EAAE;QACxBX,QAAQ,CAACC,cAAc,CAAC,MAAM,CAAC,CAACS,SAAS,GAAGC,KAAK;MACnD,CAAC;MACDf,KAAK,EAAE,UAAUA,KAAK,EAAE;QACtBI,QAAQ,CAACC,cAAc,CAAC,MAAM,CAAC,CAACS,SAAS,GAAG,mCAAmC;MACjF;IACF,CAAC,CAAC;EAGJ,CAAC;EAED,oBACE;IAAA,wBACE;MAAA,uDAA8B;QAAA;MAAA;QAAA;QAAA;QAAA;MAAA,QAA6B,qDAAkC;QAAA;MAAA;QAAA;QAAA;QAAA;MAAA,QAAgC;IAAA;MAAA;MAAA;MAAA;IAAA,QACzH,eACJ;MAAQ,OAAO,EAAEP,KAAM;MAAA;IAAA;MAAA;MAAA;MAAA;IAAA,QAEd,eACT;MAAG,EAAE,EAAC,OAAO;MAAA;IAAA;MAAA;MAAA;MAAA;IAAA,QAAM,eACnB;MAAG,EAAE,EAAC,MAAM;MAAA;IAAA;MAAA;MAAA;MAAA;IAAA,QAAM;EAAA,gBACjB;AAEP;AAAC,MA5CQD,UAAU;AA6CnBzC,QAAQ,CAACsC,MAAM,eAAC,QAAC,UAAU;EAAA;EAAA;EAAA;AAAA,QAAG,EAAEC,QAAQ,CAACC,cAAc,CAAC,MAAM,CAAC,CAAC;AAAC;AAAA;AAAA"},"metadata":{},"sourceType":"module"}